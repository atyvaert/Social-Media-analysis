---
title: "R Notebook"
output: html_notebook
---

```{r}
set.seed(123)
rm(list = ls())
library(AUC)
library(pROC)

load("/Users/wouterdewitte/Documents/GitHub/SMWA_Performance/data/basetable_train.RData")

load("/Users/wouterdewitte/Documents/GitHub/SMWA_Performance/data/basetable_test.RData")
```

```{r}
#make variables
train_x <- subset(basetable_train, select = -Target)
train_y <- basetable_train$Target

test_x <- subset(basetable_test, select = -Target)
test_y <- basetable_test$Target

test_y <- ifelse(test_y < 0, 0, 1)
train_y <- ifelse(train_y < 0, 0, 1)
```

```{r}
#build model
model_binomial <-  glm(train_y ~ ., data = train_x, family = "binomial")

model_proportions <- predict(model_binomial, newdata = test_x, type = "response")

model_proportions[model_proportions >= 0.5] <- 1
model_proportions[model_proportions < 0.5] <- 0

pROC::auc(test_y,model_proportions)

```

